# 测试规范（test）

目标：测试覆盖核心业务（Domain/Use Case）与关键交互，确保重构安全与交付质量。

## 1. 存放位置

- 每个 feature 的测试放在 `src/features/<feature>/test/`
- 测试按分层就近组织（推荐）：
  - `test/domain/*`：领域实体/值对象/用例（优先）
  - `test/data/*`：mapper、repository 实现（可选）
  - `test/presentation/*`：组件/页面（可选）

## 2. 命名规则

- 文件名建议：`*.spec.ts`（单测），`*.e2e.ts`（端到端，如后续引入）
- 以“行为”命名用例（Given/When/Then），避免紧贴实现细节。

## 3. 分层测试策略

- Domain/Use Case（推荐强制覆盖）：
  - 纯 TS、无 DOM、无网络依赖
  - repository 使用 mock 实现（见模拟规范）
- Data（按需）：
  - 重点测试 DTO→Domain 的映射、错误映射
  - 不建议直接依赖真实后端；可用 MSW 或 stub HttpClient
- Presentation（按需）：
  - 只测关键交互与渲染状态（loading/error/empty）
  - 不在 UI 层复测 Domain 的业务规则

## 4. 最小质量门槛（建议）

- 新增/修改的 Use Case 必须提供对应单测
- 修复 bug 必须补回归测试（先失败后通过）

